# PR11 Visual Guide: Smart Lead Conversion & OTP 🎨

راهنمای بصری سیستم تبدیل لید هوشمند و احراز هویت یک‌کلیکی

---

## 📱 User Journey (سفر کاربر)

### قبل از PR11 ❌

```
کاربر با هما چت می‌کند
         ↓
اطلاعات محصول می‌گیرد
         ↓
"فردا تماس می‌گیرم" می‌گوید
         ↓
❌ هیچ پیگیری نمی‌شود
❌ اطلاعات ضایع می‌شود
❌ فروش از دست می‌رود
```

### بعد از PR11 ✅

```
کاربر با هما چت می‌کند
         ↓
هما نیازها را شناسایی می‌کند
         ↓
📝 فرم زیبا برای دریافت اطلاعات
         ↓
📱 ارسال کد OTP (30 ثانیه)
         ↓
✅ ثبت‌نام خودکار
         ↓
🛒 سفارش پیش‌نویس ایجاد می‌شود
         ↓
🔔 تیم فروش مطلع می‌شود
         ↓
✅ پیگیری حرفه‌ای
```

---

## 🎨 UI Components

### 1. Lead Capture Form

```
┌─────────────────────────────────┐
│   📝 اطلاعات تماس               │
│   برای دریافت پیشنهاد قیمت      │
├─────────────────────────────────┤
│                                 │
│  نام و نام خانوادگی *          │
│  ┌───────────────────────────┐  │
│  │ مثال: علی احمدی          │  │
│  └───────────────────────────┘  │
│                                 │
│  شماره موبایل *                 │
│  ┌───────────────────────────┐  │
│  │ 09123456789              │  │
│  └───────────────────────────┘  │
│                                 │
│  نام شرکت (اختیاری)             │
│  ┌───────────────────────────┐  │
│  │ مثال: چاپ‌کو              │  │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │   ✓ ارسال اطلاعات         │  │
│  └───────────────────────────┘  │
│                                 │
│  🔒 اطلاعات شما امن است         │
└─────────────────────────────────┘
```

**انیمیشن:**
- ✨ Slide up از پایین
- 🎨 Gradient background
- 💫 Pulse روی آیکون
- ⚡ Smooth transitions

---

### 2. OTP Flow - Stage 1 (Phone Input)

```
┌─────────────────────────────────┐
│   📱 ورود یا ثبت‌نام             │
│   برای ادامه، شماره خود را      │
│   وارد کنید                      │
├─────────────────────────────────┤
│                                 │
│  ┌───────────────────────────┐  │
│  │     09123456789          │  │
│  └───────────────────────────┘  │
│                                 │
│  ┌───────────────────────────┐  │
│  │  → دریافت کد تایید        │  │
│  └───────────────────────────┘  │
│                                 │
│  با ورود یا ثبت‌نام، قوانین    │
│  را می‌پذیرید                   │
└─────────────────────────────────┘
```

---

### 3. OTP Flow - Stage 2 (Code Input)

```
┌─────────────────────────────────┐
│   🔐 کد تایید                    │
│   کد 6 رقمی ارسال شده به        │
│   09123456789                   │
├─────────────────────────────────┤
│                                 │
│   ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐ │
│   │1 │ │2 │ │3 │ │4 │ │5 │ │6 │ │
│   └──┘ └──┘ └──┘ └──┘ └──┘ └──┘ │
│                                 │
│   ⏰ زمان باقی‌مانده: 1:45      │
│                                 │
│   در حال بررسی... 🔄            │
│                                 │
│  ┌───────────────────────────┐  │
│  │  ارسال مجدد (1:45)        │  │
│  └───────────────────────────┘  │
└─────────────────────────────────┘
```

**ویژگی‌ها:**
- ✨ Auto-focus روی اولین input
- 📋 Paste support
- ⌨️ Arrow navigation
- ⏱️ Countdown timer
- 🔄 Resend button (بعد از expiry)

---

## 📊 Lead Scoring Visual

```
📈 الگوریتم امتیازدهی (0-100)

منبع ورودی         ████████████░░░░░░░░  18/18 ⭐
حجم سفارش           ████████████████░░░░  20/25 🎯
نوع محصول           ████████████░░░░░░░░  15/15 💎
میزان تعامل         ████████░░░░░░░░░░░░  10/18 💬
کامل بودن اطلاعات    ████████████████████  25/30 ✅
سرعت تصمیم‌گیری     ████████░░░░░░░░░░░░  10/10 ⚡

═══════════════════════════════════════
مجموع امتیاز:       ████████████████░░░░  88/100

وضعیت: 🔥 HOT LEAD
اولویت: ⚠️ فوری
```

---

## 🔔 Notification Screens

### 1. SMS به مدیر

```
┌─────────────────────────────┐
│  از: هما                    │
│  به: 09123456789 (مدیر)     │
├─────────────────────────────┤
│  هما: لید جدید              │
│  نام: علی احمدی             │
│  امتیاز: 88                 │
│  تماس: 09111111111          │
│                             │
│  [لحظه دریافت: 14:32]      │
└─────────────────────────────┘
```

---

### 2. Email به ادمین

```
┌──────────────────────────────────────┐
│  موضوع: 🔥 لید جدید با اولویت بالا  │
│  از: هما <noreply@site.com>         │
│  به: admin@site.com                 │
├──────────────────────────────────────┤
│                                      │
│  ╔═══════════════════════════════╗   │
│  ║  🤖 دستیار هوشمند هما        ║   │
│  ╚═══════════════════════════════╝   │
│                                      │
│  🔥 لید جدید با اولویت بالا        │
│                                      │
│  ┌────────────────────────────┐      │
│  │ امتیاز لید     88/100     │      │
│  │ وضعیت          hot         │      │
│  │ نام           علی احمدی    │      │
│  │ اطلاعات تماس  09111111111  │      │
│  │ منبع          instagram    │      │
│  └────────────────────────────┘      │
│                                      │
│  مشخصات درخواست:                     │
│  • تیراژ: 5000                       │
│  • نوع کاغذ: گلاسه 150 گرم          │
│  • نوع چاپ: چاپ افست                │
│                                      │
│  ┌────────────────────────────┐      │
│  │  مشاهده سفارش پیش‌نویس     │      │
│  └────────────────────────────┘      │
│                                      │
│  این ایمیل توسط هما ارسال شده       │
└──────────────────────────────────────┘
```

---

### 3. Dashboard Notification

```
┌─────────────────────────────────────┐
│  اطلس Dashboard                     │
├─────────────────────────────────────┤
│                                     │
│  🔔 نوتیفیکیشن‌ها (1 جدید)         │
│                                     │
│  ┌───────────────────────────────┐  │
│  │ 🔥 لید جدید با اولویت بالا │  │
│  │ مشتری علی احمدی با امتیاز   │  │
│  │ 88 ثبت شد                    │  │
│  │ [2 دقیقه پیش]                │  │
│  │ ┌─────────┐ ┌──────────────┐ │  │
│  │ │ مشاهده  │ │ پیگیری کن    │ │  │
│  │ └─────────┘ └──────────────┘ │  │
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

---

## ⚙️ Atlas Settings UI

```
┌─────────────────────────────────────────────┐
│  اطلس → تنظیمات                             │
├─────────────────────────────────────────────┤
│                                             │
│  ... (سایر تنظیمات) ...                     │
│                                             │
│  ╔═══════════════════════════════════════╗  │
│  ║  📱 تنظیمات ملی‌پیامک (SMS Service)   ║  │
│  ╚═══════════════════════════════════════╝  │
│                                             │
│  نام کاربری ملی‌پیامک                      │
│  ┌───────────────────────────────────────┐  │
│  │ username                              │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  رمز عبور                                   │
│  ┌───────────────────────────────────────┐  │
│  │ ••••••••                              │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  شماره فرستنده                              │
│  ┌───────────────────────────────────────┐  │
│  │ +981000...                            │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  کد الگوی OTP                               │
│  ┌───────────────────────────────────────┐  │
│  │ pattern_12345                         │  │
│  └───────────────────────────────────────┘  │
│  کد الگوی پیامک برای ارسال کد تایید       │
│                                             │
│  کد الگوی اطلاع‌رسانی لید                  │
│  ┌───────────────────────────────────────┐  │
│  │ pattern_67890                         │  │
│  └───────────────────────────────────────┘  │
│  کد الگوی پیامک برای اطلاع‌رسانی لیدها    │
│                                             │
│  شماره موبایل مدیر                          │
│  ┌───────────────────────────────────────┐  │
│  │ 09123456789                           │  │
│  └───────────────────────────────────────┘  │
│  برای دریافت هشدارهای لیدهای Hot          │
│                                             │
│  ☑ فعال‌سازی اطلاع‌رسانی لید               │
│                                             │
│  حداقل امتیاز برای اطلاع‌رسانی             │
│  ┌────┐                                    │
│  │ 70 │ (Hot Lead Threshold)              │
│  └────┘                                    │
│  فقط لیدها با امتیاز ≥70 اطلاع‌رسانی می‌شوند │
│                                             │
│  💡 نکته: برای دریافت کد الگوها، به پنل   │
│  ملی‌پیامک مراجعه کنید                     │
│                                             │
│  ┌───────────────┐  ┌──────────────────┐   │
│  │ 💾 ذخیره      │  │ 🔄 بازگشت       │   │
│  └───────────────┘  └──────────────────┘   │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 🔄 Data Flow Diagram

```
┌─────────────┐
│   کاربر     │
│  (Frontend) │
└──────┬──────┘
       │
       │ 1. Chat با هما
       │
       ▼
┌──────────────────┐
│  React Component │
│ LeadCaptureForm  │
└──────┬───────────┘
       │
       │ 2. Submit (نام + موبایل)
       │
       ▼
┌──────────────────┐
│   homaLeadAPI    │
│ (Frontend Service)│
└──────┬───────────┘
       │
       │ 3. POST /homa/v1/leads
       │
       ▼
┌──────────────────┐
│ HT_Lead_REST_API │
│   (Backend)      │
└──────┬───────────┘
       │
       │ 4. calculate_score()
       │
       ▼
┌──────────────────┐
│  Lead Scoring    │
│   Algorithm      │
└──────┬───────────┘
       │
       │ 5. Score: 88
       │
       ▼
┌──────────────────┐
│  wp_homa_leads   │
│   (Database)     │
└──────┬───────────┘
       │
       │ 6. if Score ≥ 70
       │
       ├─────────────────┬─────────────────┐
       │                 │                 │
       ▼                 ▼                 ▼
┌──────────┐    ┌──────────────┐   ┌──────────┐
│   SMS    │    │    Email     │   │Dashboard │
│ (Admin)  │    │   (Admin)    │   │  Atlas   │
└──────────┘    └──────────────┘   └──────────┘
       │                 │                 │
       │                 │                 │
       └─────────────────┴─────────────────┘
                         │
                         ▼
              ┌──────────────────┐
              │  تیم فروش پیگیری│
              │     می‌کند       │
              └──────────────────┘
```

---

## 🎬 Animation Timeline

### LeadCaptureForm

```
t=0ms    ┃ opacity: 0, translateY(20px)
t=300ms  ┃ opacity: 1, translateY(0)      [SlideUp]
         ┃
user     ┃ 
types    ┃ validation real-time
         ┃ border: red → green
         ┃
click    ┃
submit   ┃ button: scale(1) → scale(0.95)
         ┃ spinner appears
         ┃
success  ┃ ✅ checkmark animation
```

### OTPInput

```
t=0ms    ┃ inputs appear
         ┃ first input auto-focus
         ┃
user     ┃
types    ┃ auto-move to next input
         ┃ scale(1) → scale(1.05) [focus]
         ┃
paste    ┃
6-digit  ┃ all inputs fill
         ┃ auto-submit after 100ms
         ┃
verify   ┃ loading spinner
         ┃ success: green checkmark
         ┃ error: shake animation
```

---

## 📱 Mobile Responsive

### Desktop (1920x1080)

```
┌──────────────────────────────────────┐
│  Chat Sidebar (400px)  │  Main Area │
│                        │             │
│  ┌──────────────────┐  │             │
│  │ LeadCaptureForm │  │             │
│  │                  │  │             │
│  │  [Full Width]    │  │             │
│  │                  │  │             │
│  └──────────────────┘  │             │
│                        │             │
└──────────────────────────────────────┘
```

### Mobile (375x667)

```
┌─────────────────┐
│   Full Screen   │
│                 │
│ ┌─────────────┐ │
│ │ Lead Form   │ │
│ │             │ │
│ │ [Optimized] │ │
│ │             │ │
│ │ Font: 16px  │ │
│ │ (No zoom)   │ │
│ │             │ │
│ └─────────────┘ │
│                 │
└─────────────────┘
```

---

## 🎨 Color Palette

```
Primary Gradient:
┌────┐ ┌────┐
│#667│→│#764│  (Purple Gradient)
│eea │ │ba2 │
└────┘ └────┘

Status Colors:
🔥 Hot:     #e53e3e (Red)
⚡ Warm:    #f59e0b (Orange)
💼 Medium:  #3b82f6 (Blue)
❄️  Cold:   #6b7280 (Gray)

UI Colors:
✅ Success: #10b981
❌ Error:   #e53e3e
⚠️  Warning: #f59e0b
ℹ️  Info:    #3b82f6
```

---

## 🔐 Security Visual

```
┌──────────────────────────────────────┐
│        Security Layers               │
├──────────────────────────────────────┤
│                                      │
│  Layer 1: Rate Limiting              │
│  ├─ 3 requests/hour                  │
│  └─ Per phone number                 │
│                                      │
│  Layer 2: OTP Expiration             │
│  ├─ 2 minutes validity               │
│  └─ Auto-cleanup (Cron)              │
│                                      │
│  Layer 3: Max Attempts               │
│  ├─ 5 tries maximum                  │
│  └─ Then request new code            │
│                                      │
│  Layer 4: Validation                 │
│  ├─ Iranian phone format             │
│  └─ Input sanitization               │
│                                      │
│  Layer 5: Permission Checks          │
│  ├─ Admin endpoints                  │
│  └─ current_user_can()               │
│                                      │
└──────────────────────────────────────┘
```

---

## ⚡ Performance Metrics

```
Benchmark Results:

┌─────────────────────┬─────────┐
│ عملیات              │ زمان    │
├─────────────────────┼─────────┤
│ Send OTP            │ <1.0s   │
│ Verify OTP          │ <0.5s   │
│ Create Lead         │ <0.3s   │
│ Calculate Score     │ <0.1s   │
│ Draft Order         │ <1.0s   │
│ Send SMS            │ <2.0s   │
│ Send Email          │ <1.5s   │
└─────────────────────┴─────────┘

Total User Flow: ~5 seconds
(از شروع تا ثبت‌نام کامل)
```

---

## 🎯 Success States

### Success Animation

```
   Step 1          Step 2          Step 3
   ┌────┐         ┌────┐         ┌────┐
   │ ✓  │    →    │ ✓✓ │    →    │✓✓✓│
   └────┘         └────┘         └────┘
  Submit        Verify        Complete

  [Scale + Fade]  [Bounce]    [Confetti]
```

### Error Animation

```
   Normal          Error           Shake
   ┌────┐         ┌────┐         ┌────┐
   │    │    →    │ ❌ │    →    │❌❌│
   └────┘         └────┘         └────┘
                                 
  [Border Red]   [Shake Left]  [Shake Right]
```

---

## 📊 Analytics Dashboard (آینده)

```
┌────────────────────────────────────────┐
│  Lead Pipeline Analytics               │
├────────────────────────────────────────┤
│                                        │
│  📈 Conversion Funnel                  │
│                                        │
│  Chat Started       1000  ████████████ │
│      ↓                                 │
│  Lead Captured       750  █████████    │
│      ↓                                 │
│  OTP Verified        600  ████████     │
│      ↓                                 │
│  Draft Order         450  ██████       │
│      ↓                                 │
│  Converted           300  ████         │
│                                        │
│  Conversion Rate: 30% 📊               │
│                                        │
│  ┌──────────────────────────────────┐  │
│  │  Hot Leads This Week: 45        │  │
│  │  Avg Response Time: 3.5 min     │  │
│  │  SMS Delivery Rate: 98%         │  │
│  └──────────────────────────────────┘  │
│                                        │
└────────────────────────────────────────┘
```

---

## 🎓 Best Practices Applied

```
✅ Mobile-First Design
✅ Progressive Enhancement
✅ Accessibility (ARIA)
✅ RTL Support
✅ Loading States
✅ Error Handling
✅ Validation Feedback
✅ Smooth Animations
✅ Security First
✅ Performance Optimized
```

---

<div align="center">

**🎨 پایان راهنمای بصری PR11 🎨**

*تبدیل هوشمند لید + احراز هویت یک‌کلیکی*

[⬆ بازگشت به بالا](#pr11-visual-guide-smart-lead-conversion--otp-)

</div>
