<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Parallel UI</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        .example {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-right: 4px solid #667eea;
            border-radius: 4px;
        }
        .example h3 {
            margin-top: 0;
            color: #333;
        }
        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            direction: ltr;
            text-align: left;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .result {
            background: #d4edda;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            border: 1px solid #c3e6cb;
            display: none;
        }
        .error {
            background: #f8d7da;
            border-color: #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Parallel UI</h1>
        <p>Ø§ÛŒÙ† ØµÙØ­Ù‡ Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø± Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Parallel UI Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.</p>

        <!-- Ù…Ø«Ø§Ù„ 1: Ø¨Ø§Ø²/Ø¨Ø³ØªÙ‡ Ú©Ø±Ø¯Ù† -->
        <div class="example">
            <h3>Û±. Ø¨Ø§Ø² Ùˆ Ø¨Ø³ØªÙ‡ Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±</h3>
            <p>Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø±Ø§ Ú©Ù†ØªØ±Ù„ Ú©Ù†ÛŒØ¯:</p>
            <button onclick="openSidebar()">Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±</button>
            <button onclick="closeSidebar()">Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±</button>
            <button onclick="toggleSidebar()">Toggle Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±</button>
            <div id="result1" class="result"></div>
            
            <div class="code-block">
<pre>
function openSidebar() {
    document.dispatchEvent(new CustomEvent('homa:open-sidebar'));
}

function closeSidebar() {
    document.dispatchEvent(new CustomEvent('homa:close-sidebar'));
}

function toggleSidebar() {
    document.dispatchEvent(new CustomEvent('homa:toggle-sidebar'));
}
</pre>
            </div>
        </div>

        <!-- Ù…Ø«Ø§Ù„ 2: Highlight Ú©Ø±Ø¯Ù† Ø¹Ù†Ø§ØµØ± -->
        <div class="example">
            <h3>Û². Highlight Ú©Ø±Ø¯Ù† Ø¹Ù†Ø§ØµØ±</h3>
            <p>Ø§ÛŒÙ† Ø¹Ù†Ø§ØµØ± Ø±Ø§ highlight Ú©Ù†ÛŒØ¯:</p>
            <button id="test-btn-1" onclick="highlightMe('test-btn-1')">Ø¯Ú©Ù…Ù‡ Û±</button>
            <button id="test-btn-2" onclick="highlightMe('test-btn-2')">Ø¯Ú©Ù…Ù‡ Û²</button>
            <button id="test-btn-3" onclick="highlightMe('test-btn-3')">Ø¯Ú©Ù…Ù‡ Û³</button>
            <div id="result2" class="result"></div>
            
            <div class="code-block">
<pre>
function highlightMe(elementId) {
    if (window.HomaOrchestrator) {
        window.HomaOrchestrator.executeOnSite(
            '#' + elementId, 
            'highlight'
        );
    }
}
</pre>
            </div>
        </div>

        <!-- Ù…Ø«Ø§Ù„ 3: Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª -->
        <div class="example">
            <h3>Û³. Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª Viewport</h3>
            <p>Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ viewport Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯:</p>
            <button onclick="getViewportState()">Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª</button>
            <div id="result3" class="result"></div>
            
            <div class="code-block">
<pre>
function getViewportState() {
    const state = window.HomaOrchestrator.getViewportState();
    console.log(state);
}
</pre>
            </div>
        </div>

        <!-- Ù…Ø«Ø§Ù„ 4: Ø§Ø±Ø³Ø§Ù„ ØªØºÛŒÛŒØ±Ø§Øª ÙØ±Ù… -->
        <div class="example">
            <h3>Û´. Ø§Ø±Ø³Ø§Ù„ ØªØºÛŒÛŒØ±Ø§Øª ÙØ±Ù… Ø¨Ù‡ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±</h3>
            <p>Ø§ÛŒÙ† ÙØ±Ù… Ø³Ø§Ø¯Ù‡ Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯:</p>
            <form id="test-form">
                <input type="text" id="book_title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ú©ØªØ§Ø¨" style="padding: 10px; width: 300px; margin: 5px;">
                <input type="number" id="pages" placeholder="ØªØ¹Ø¯Ø§Ø¯ ØµÙØ­Ø§Øª" style="padding: 10px; width: 200px; margin: 5px;">
                <input type="number" id="quantity" placeholder="ØªÛŒØ±Ø§Ú˜" style="padding: 10px; width: 200px; margin: 5px;">
            </form>
            <button onclick="sendFormChanges()">Ø§Ø±Ø³Ø§Ù„ ØªØºÛŒÛŒØ±Ø§Øª Ø¨Ù‡ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±</button>
            <div id="result4" class="result"></div>
            
            <div class="code-block">
<pre>
function sendFormChanges() {
    const title = document.getElementById('book_title').value;
    const pages = document.getElementById('pages').value;
    
    window.dispatchEvent(new CustomEvent('homa_site_updated', {
        detail: {
            fieldId: 'book_title',
            value: title,
            fieldType: 'text'
        }
    }));
}
</pre>
            </div>
        </div>

        <!-- Ù…Ø«Ø§Ù„ 5: ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ API -->
        <div class="example">
            <h3>Ûµ. Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ù‡Ù…Ø§ (REST API)</h3>
            <p>ÛŒÚ© Ù¾ÛŒØ§Ù… ØªØ³ØªÛŒ Ø¨Ù‡ Ù‡Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯:</p>
            <textarea id="test-message" rows="3" style="width: 100%; padding: 10px; direction: rtl;" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...">Ø³Ù„Ø§Ù…ØŒ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù… Ú©ØªØ§Ø¨Ù… Ø±Ø§ Ú†Ø§Ù¾ Ú©Ù†Ù…</textarea>
            <button onclick="sendTestMessage()">Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ù‡Ù…Ø§</button>
            <div id="result5" class="result"></div>
            
            <div class="code-block">
<pre>
async function sendTestMessage() {
    const message = document.getElementById('test-message').value;
    
    const response = await fetch('/wp-json/homaye/v1/ai/chat', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-WP-Nonce': homayeParallelUIConfig.nonce
        },
        body: JSON.stringify({
            message: message,
            context: { page: window.location.pathname }
        })
    });
    
    const data = await response.json();
    console.log(data);
}
</pre>
            </div>
        </div>

        <!-- Ù…Ø«Ø§Ù„ 6: Scroll Ø¨Ù‡ Ø¹Ù†ØµØ± -->
        <div class="example">
            <h3>Û¶. Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ø¹Ù†Ø§ØµØ± Ù…Ø®ØªÙ„Ù</h3>
            <button onclick="scrollToElement('h1')">Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡</button>
            <button onclick="scrollToElement('#test-form')">Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ ÙØ±Ù…</button>
            <div id="result6" class="result"></div>
            
            <div class="code-block">
<pre>
function scrollToElement(selector) {
    if (window.HomaOrchestrator) {
        window.HomaOrchestrator.executeOnSite(
            selector, 
            'scroll'
        );
    }
}
</pre>
            </div>
        </div>

        <!-- Ù…Ø«Ø§Ù„ 7: LocalStorage -->
        <div class="example">
            <h3>Û·. Ù…Ø¯ÛŒØ±ÛŒØª Chat History Ø¯Ø± LocalStorage</h3>
            <button onclick="getChatHistory()">Ø¯Ø±ÛŒØ§ÙØª History</button>
            <button onclick="clearChatHistory()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† History</button>
            <div id="result7" class="result"></div>
            
            <div class="code-block">
<pre>
function getChatHistory() {
    const history = localStorage.getItem('homa_chat_history');
    console.log(JSON.parse(history));
}

function clearChatHistory() {
    localStorage.removeItem('homa_chat_history');
}
</pre>
            </div>
        </div>
    </div>

    <script>
        // Example 1: Ø¨Ø§Ø²/Ø¨Ø³ØªÙ‡ Ú©Ø±Ø¯Ù†
        function openSidebar() {
            document.dispatchEvent(new CustomEvent('homa:open-sidebar'));
            showResult('result1', 'Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¨Ø§Ø² Ø´Ø¯!');
        }

        function closeSidebar() {
            document.dispatchEvent(new CustomEvent('homa:close-sidebar'));
            showResult('result1', 'Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¨Ø³ØªÙ‡ Ø´Ø¯!');
        }

        function toggleSidebar() {
            document.dispatchEvent(new CustomEvent('homa:toggle-sidebar'));
            showResult('result1', 'ÙˆØ¶Ø¹ÛŒØª Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± ØªØºÛŒÛŒØ± Ú©Ø±Ø¯!');
        }

        // Example 2: Highlight
        function highlightMe(elementId) {
            if (window.HomaOrchestrator) {
                window.HomaOrchestrator.executeOnSite('#' + elementId, 'highlight');
                showResult('result2', `Ø¹Ù†ØµØ± ${elementId} highlight Ø´Ø¯!`);
            } else {
                showResult('result2', 'HomaOrchestrator Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª!', true);
            }
        }

        // Example 3: ÙˆØ¶Ø¹ÛŒØª
        function getViewportState() {
            if (window.HomaOrchestrator) {
                const state = window.HomaOrchestrator.getViewportState();
                showResult('result3', `
                    <strong>ÙˆØ¶Ø¹ÛŒØª Viewport:</strong><br>
                    - Ø¨Ø§Ø² Ø§Ø³Øª: ${state.isOpen ? 'Ø¨Ù„Ù‡' : 'Ø®ÛŒØ±'}<br>
                    - Ø¹Ø±Ø¶ Ø³Ø§ÛŒØª: ${state.siteViewWidth}px<br>
                    - Ø¹Ø±Ø¶ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±: ${state.sidebarViewWidth}px<br>
                    - Ø¹Ø±Ø¶ Ú©Ù„: ${state.totalWidth}px
                `);
            } else {
                showResult('result3', 'HomaOrchestrator Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª!', true);
            }
        }

        // Example 4: ÙØ±Ù…
        function sendFormChanges() {
            const title = document.getElementById('book_title').value;
            const pages = document.getElementById('pages').value;
            const quantity = document.getElementById('quantity').value;

            if (!title && !pages && !quantity) {
                showResult('result4', 'Ù„Ø·ÙØ§Ù‹ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© ÙÛŒÙ„Ø¯ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯!', true);
                return;
            }

            if (title) {
                window.dispatchEvent(new CustomEvent('homa_site_updated', {
                    detail: { fieldId: 'book_title', value: title, fieldType: 'text' }
                }));
            }

            showResult('result4', 'ØªØºÛŒÛŒØ±Ø§Øª ÙØ±Ù… Ø¨Ù‡ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯!');
        }

        // Example 5: API
        async function sendTestMessage() {
            const message = document.getElementById('test-message').value;
            
            if (!message.trim()) {
                showResult('result5', 'Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ù¾ÛŒØ§Ù… Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯!', true);
                return;
            }

            showResult('result5', 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...');

            try {
                const response = await fetch('/wp-json/homaye/v1/ai/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-WP-Nonce': window.homayeParallelUIConfig?.nonce || ''
                    },
                    body: JSON.stringify({
                        message: message,
                        context: { page: window.location.pathname }
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    showResult('result5', `
                        <strong>Ù¾Ø§Ø³Ø® Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯:</strong><br>
                        ${data.response}
                    `);
                } else {
                    showResult('result5', 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø®', true);
                }
            } catch (error) {
                showResult('result5', `Ø®Ø·Ø§: ${error.message}`, true);
            }
        }

        // Example 6: Scroll
        function scrollToElement(selector) {
            if (window.HomaOrchestrator) {
                window.HomaOrchestrator.executeOnSite(selector, 'scroll');
                showResult('result6', `Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ ${selector}`);
            } else {
                showResult('result6', 'HomaOrchestrator Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª!', true);
            }
        }

        // Example 7: LocalStorage
        function getChatHistory() {
            const history = localStorage.getItem('homa_chat_history');
            if (history) {
                const parsed = JSON.parse(history);
                showResult('result7', `
                    <strong>Chat History:</strong><br>
                    ØªØ¹Ø¯Ø§Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§: ${parsed.messages?.length || 0}<br>
                    Ù¾Ø±Ø³ÙˆÙ†Ø§: ${parsed.persona || 'ØªØ¹ÛŒÛŒÙ† Ù†Ø´Ø¯Ù‡'}
                `);
            } else {
                showResult('result7', 'Ù‡ÛŒÚ† historyâ€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
            }
        }

        function clearChatHistory() {
            localStorage.removeItem('homa_chat_history');
            showResult('result7', 'Chat history Ù¾Ø§Ú© Ø´Ø¯!');
        }

        // Helper
        function showResult(elementId, message, isError = false) {
            const el = document.getElementById(elementId);
            el.style.display = 'block';
            el.innerHTML = message;
            if (isError) {
                el.classList.add('error');
            } else {
                el.classList.remove('error');
            }
            
            setTimeout(() => {
                el.style.display = 'none';
            }, 5000);
        }

        // Auto-detect form changes
        document.getElementById('test-form')?.addEventListener('input', (e) => {
            console.log('Form changed:', e.target.id, '=', e.target.value);
        });
    </script>
</body>
</html>
